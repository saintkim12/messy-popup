var __defProp=Object.defineProperty,__defNormalProp=(t,l,e)=>l in t?__defProp(t,l,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[l]=e,__publicField=(t,l,e)=>(__defNormalProp(t,"symbol"!=typeof l?l+"":l,e),e);!function(t,l){"object"==typeof exports&&"undefined"!=typeof module?module.exports=l():"function"==typeof define&&define.amd?define(l):(t="undefined"!=typeof globalThis?globalThis:t||self).MessyPopup=l()}(this,(function(){"use strict";const t="data-messy-content",l="data-messy-draggable-handle",e="messy-popup";class o{convertTextToElement(t){const l=document.createElement("div");return l.innerHTML=t,l.firstElementChild}show(t){return t.style.visibility="",t}hide(t){return t.style.visibility="hidden",t}destroy(t){var l,e;return null!=(e=null==(l=t.parentNode)?void 0:l.removeChild(t))?e:t}setDraggable(t,l){return!1===l?this.unbindDraggable.call(t,t):this.bindDraggable.call(t,t),t}insertCss(t){const l=Array.from(document.styleSheets).find((t=>null===t.href))||(()=>{var t;const l=document.createElement("style");return l.setAttribute("data-messy-popup","true"),null==(t=document.querySelector("head"))||t.appendChild(l),Array.from(document.styleSheets).find((t=>null===t.href))})();return!!l&&l.insertRule(t,l.cssRules.length)>=0}unbindDraggable(t){var e;const o=null!=(e=t.querySelector("["+l+"]"))?e:t;t===o&&o.removeAttribute(l),o.onmousedown=null}bindDraggable(t){var e;let o=0,n=0,i=0,s=0;const r=null!=(e=t.querySelector("["+l+"]"))?e:t;function u(l){l.preventDefault(),o=i-l.clientX,n=s-l.clientY,i=l.clientX,s=l.clientY,t.style.bottom&&(t.style.top=t.offsetTop+"px",t.style.bottom=""),t.style.right&&(t.style.left=t.offsetLeft+"px",t.style.right=""),t.style.top=t.offsetTop-n+"px",t.style.left=t.offsetLeft-o+"px"}function d(){document.onmouseup=null,document.onmousemove=null}t===r&&r.setAttribute(l,""),r.onmousedown=function(t){t.preventDefault(),i=t.clientX,s=t.clientY,document.onmouseup=d,document.onmousemove=u}}}class n{constructor(){__publicField(this,"popupInfo"),__publicField(this,"_config"),__publicField(this,"instanceConfig"),__publicField(this,"htmlUtil"),this.htmlUtil=new o,this.popupInfo={},this.instanceConfig=void 0,this._config={root:"body",wrapper:document.createElement("div"),global:{draggable:!0,style:{zIndex:1e3}}},this.setConfig()}init(){return[".messy-popup { background-color: #fff; }",`[${l}] { cursor: move; }`].forEach(this.htmlUtil.insertCss),this}addPopupInfo(t,l){this.popupInfo[t]=l}removePopupInfo(t){delete this.popupInfo[t]}setConfig(t){var l,e,o,n,i,s,r,u,d,a,p,h,g,c,f,b,v,y,m,w,_,I,P,D,x,C,S;const E=(...t)=>t.find((t=>void 0!==t)),T=this._config,z={root:E(null==t?void 0:t.root,T.root),wrapper:E(null==t?void 0:t.wrapper,T.wrapper),global:{draggable:E(null==(l=null==t?void 0:t.global)?void 0:l.draggable,T.global.draggable),style:{zIndex:E(null==(o=null==(e=null==t?void 0:t.global)?void 0:e.style)?void 0:o.zIndex,null==(n=null==t?void 0:t.global)?void 0:n.zIndex,null==(s=null==(i=null==T?void 0:T.global)?void 0:i.style)?void 0:s.zIndex),top:E(null==(u=null==(r=null==t?void 0:t.global)?void 0:r.style)?void 0:u.top,null==(d=T.global.style)?void 0:d.top),left:E(null==(p=null==(a=null==t?void 0:t.global)?void 0:a.style)?void 0:p.left,null==(h=T.global.style)?void 0:h.left),bottom:E(null==(c=null==(g=null==t?void 0:t.global)?void 0:g.style)?void 0:c.bottom,null==(f=T.global.style)?void 0:f.bottom),right:E(null==(v=null==(b=null==t?void 0:t.global)?void 0:b.style)?void 0:v.right,null==(y=T.global.style)?void 0:y.right),position:E(null==(w=null==(m=null==t?void 0:t.global)?void 0:m.style)?void 0:w.position,null==(_=T.global.style)?void 0:_.position),width:E(null==(P=null==(I=null==t?void 0:t.global)?void 0:I.style)?void 0:P.width,null==(D=T.global.style)?void 0:D.width),height:E(null==(C=null==(x=null==t?void 0:t.global)?void 0:x.style)?void 0:C.height,null==(S=T.global.style)?void 0:S.height)}}};return this.instanceConfig=z,this}createPopup(...o){var n;const i=this.instanceConfig,s=document.querySelector(null!=(n=null==i?void 0:i.root)?n:this._config.root);return o.filter((t=>t.id)).map((l=>{var o,n,s,r,u,d,a,p,h,g,c;const{id:f,wrapper:b,content:v,style:y={}}=l,{zIndex:m}=i.global,w=(t=>t instanceof HTMLElement?t:"string"==typeof t?this.htmlUtil.convertTextToElement(t):this._config.wrapper)(void 0===b?i.wrapper:b).cloneNode(!0);w.id=f,w.classList.add(e);(null!=(o=w.querySelector("[data-messy-content]"))?o:(w.setAttribute(t,""),w)).innerHTML=v,w.dataset.messyPopup="";const[_,I,P,D]=[null!=(s=null==(n=null==y?void 0:y.top)?void 0:n.toString())?s:"",null!=(u=null==(r=null==y?void 0:y.bottom)?void 0:r.toString())?u:"",null!=(a=null==(d=null==y?void 0:y.left)?void 0:d.toString())?a:"",null!=(h=null==(p=null==y?void 0:y.right)?void 0:p.toString())?h:""];w.style.top=null!=_?_:I?"":"0",w.style.bottom=I,w.style.left=null!=P?P:D?"":"0",w.style.right=D,w.style.position=(null==y?void 0:y.position)||"absolute",w.style.zIndex=(t=>{switch(typeof t){case"undefined":return"";case"number":return`${t}`;default:return t}})((null==y?void 0:y.zIndex)||(null==y?void 0:y["z-index"])||m)||"1000";const x=w.querySelector("[data-messy-content] > *:first-child"),[C,S]=[(null==(g=null==y?void 0:y.width)?void 0:g.toString())||"",(null==(c=null==y?void 0:y.height)?void 0:c.toString())||""];return x&&(x.style.width=C,x.style.height=S),w.style.visibility="hidden",w.show=()=>this.htmlUtil.show(w),w.hide=()=>this.htmlUtil.hide(w),w.destroy=()=>(this.removePopupInfo(f),this.htmlUtil.destroy(w)),w.setDraggable=()=>this.htmlUtil.setDraggable(w),w.unsetDraggable=()=>this.htmlUtil.setDraggable(w,!1),this.addPopupInfo(f,w),[w,l]})).map((([t,e])=>{var o;const n=(...t)=>{for(const l of t){const t="function"==typeof l?l():l;if("boolean"==typeof t)return t}},r=null!=(o=n(e.draggable,!!t.querySelector(`[${l}]`)||i.global.draggable))&&o,u=n(e.show,(()=>"boolean"==typeof e.hide?!e.hide:void 0),i.global.show,(()=>"boolean"==typeof i.global.hide?!i.global.hide:void 0),!0);return s.appendChild(t),r&&t.setDraggable(),u&&t.show(),t})),this}getPopup(t){return this.popupInfo[t]}show(t){return this.getPopup.call(this,t).show(),this}hide(t){return this.getPopup.call(this,t).hide(),this}destroy(t){return this.getPopup.call(this,t).destroy(),this}destroyAll(){return Object.keys(this.popupInfo).forEach((t=>this.destroy.call(this,t))),this}setDraggable(t){return this.getPopup.call(this,t).setDraggable(),this}unsetDraggable(t){return this.getPopup.call(this,t).unsetDraggable(),this}unsetDraggableAll(){return Object.keys(this.popupInfo).forEach(this.unsetDraggable),this}getPopupCount(){return Object.keys(this.popupInfo).length}forEach(t){return Object.entries(this.popupInfo).forEach((([l,e],o,n)=>t.apply(this,[[l,e],o,n]))),this}getNewInstance(){return new n}noConflict(){return this}config(t){return this.setConfig(t)}}return(new n).init()}));
//# sourceMappingURL=messy-popup.umd.js.map
