{"version":3,"sources":["messy-popup.js"],"names":["vname","aname","dataDraggableHandle","globalWrapperClassName","popupInfo","insertCss","css","sheet","window","document","styleSheets","insertRule","cssRules","length","cssList","forEach","unbindDraggable","elmnt","handleElement","querySelector","onmousedown","undefined","bindDraggable","pos1","pos2","pos3","pos4","dragMouseDown","e","event","preventDefault","clientX","clientY","onmouseup","closeDragElement","onmousemove","elementDrag","style","bottom","top","offsetTop","right","left","offsetLeft","getFunctionedValue","arg","getDefinedOrNot","args","Array","from","arguments","i","convertSelectorToElement","str","convertTextToElement","div","createElement","innerHTML","firstElementChild","addPopupInfo","id","el","removePopupInfo","show","visibility","hide","destroy","parentNode","removeChild","setDraggable","unset","call","MessyPopup","_config","root","wrapper","global","draggable","zIndex","config","o","wrapObj","key","value","_o","Object","keys","reduce","obj","assign","createPopup","isArray","apply","body","filter","item","map","content","globalZIndex","cloneNode","classList","add","dataset","name","position","child","unsetDraggable","arr","popup","appendChild","getPopup","destroyAll","unsetDraggableAll","getPopupCount","module","w","noConflict","exports","default"],"mappings":";;AAoRC,IAAA,EAAA,UAAA,GApRKA,EAAQ,aACRC,EAAQ,aACRC,EAAsB,8BACtBC,EAAyB,cAC3BC,EAAY,GAGVC,EAAY,SAASC,GACnBC,IAAAA,EAAQC,OAAOC,SAASC,YAAY,GACnCH,QAAAA,IAASA,EAAMI,WAAWL,EAAKC,EAAMK,SAASC,UAAW,IAE5DC,EAAU,CAChB,4CAGAA,EAAQC,QAAQV,GAEhB,IAAMW,EAAkB,WAClB,GAAC,KAAD,CACEC,IACAC,EADQ,KACcC,cAAc,IAAMjB,EAAsB,KAClEgB,EAEFA,EAAcE,iBAAcC,EAJhB,KAOND,iBAAcC,IAGlBC,EAAgB,WAChB,GAAC,KAAD,CACEL,IAAAA,EAAQ,KAGVM,EAAO,EAAGC,EAAO,EAAGC,EAAO,EAAGC,EAAO,EACnCR,EAAgBD,EAAME,cAAc,IAAMjB,EAAsB,KAClEgB,EAEFA,EAAcE,YAAcO,EAG5BV,EAAMG,YAAcO,EAGbA,SAAAA,EAAcC,IACrBA,EAAIA,GAAKpB,OAAOqB,OACdC,iBAEFL,EAAOG,EAAEG,QACTL,EAAOE,EAAEI,QACTvB,SAASwB,UAAYC,EAErBzB,SAAS0B,YAAcC,EAGhBA,SAAAA,EAAYR,IACnBA,EAAIA,GAAKpB,OAAOqB,OACdC,iBAEFP,EAAOE,EAAOG,EAAEG,QAChBP,EAAOE,EAAOE,EAAEI,QAChBP,EAAOG,EAAEG,QACTL,EAAOE,EAAEI,QAGLf,EAAMoB,MAAMC,SACdrB,EAAMoB,MAAME,IAAMtB,EAAMuB,UAAY,KACpCvB,EAAMoB,MAAMC,OAAS,IAGnBrB,EAAMoB,MAAMI,QACdxB,EAAMoB,MAAMK,KAAOzB,EAAM0B,WAAa,KACtC1B,EAAMoB,MAAMI,MAAQ,IAEtBxB,EAAMoB,MAAME,IAAOtB,EAAMuB,UAAYhB,EAAQ,KAC7CP,EAAMoB,MAAMK,KAAQzB,EAAM0B,WAAapB,EAAQ,KAGxCW,SAAAA,IAEPzB,SAASwB,UAAY,KACrBxB,SAAS0B,YAAc,OAIrBS,EAAqB,SAASC,GAC3B,MAAe,mBAARA,EAAqBA,IAAQA,GAEvCC,EAAkB,WAElB,IADAC,IAAAA,EAAOC,MAAMC,KAAKC,WACdC,EAAI,EAAGA,EAAIJ,EAAKlC,OAAQsC,IAC1B,QAAmB,IAAZJ,EAAKI,GAAoB,OAAOJ,EAAKI,IAK9CC,EAA2B,SAASC,GACjCA,OAAAA,GAAsB,iBAARA,EAAmB5C,SAASU,cAAckC,GAAOA,GAElEC,EAAuB,SAASD,GAChCA,GAAAA,GAAsB,iBAARA,EAAkB,CAC5BE,IAAAA,EAAM9C,SAAS+C,cAAc,OAE5BD,OADPA,EAAIE,UAAYJ,EACTE,EAAIG,kBAEJL,OAAAA,GAGLM,EAAe,SAASC,EAAIC,GAChCzD,EAAUwD,GAAMC,GAEZC,EAAkB,SAASF,UACxBxD,EAAUwD,IAEbG,EAAO,SAASF,GAEbA,OADPA,EAAGxB,MAAM2B,WAAa,GACfH,GAEHI,EAAO,SAASJ,GAEbA,OADPA,EAAGxB,MAAM2B,WAAa,SACfH,GAEHK,EAAU,SAASN,GACjBC,IAAAA,EAAKzD,EAAUwD,GAEdC,OADPC,EAAgBF,GACTC,EAAGM,WAAWC,YAAYP,IAE7BQ,EAAe,SAAST,EAAIU,GAChCA,GAAkB,IAAVA,EACFT,IAAAA,EAAKzD,EAAUwD,GACrBU,EAAQtD,EAAgBuD,KAAKV,GAAMvC,EAAciD,KAAKV,IAGpDW,EAAa,GAkIjB,GAjIAA,EAAWC,QAAU,CACnBC,KAAM,OACNC,QACclE,SAAS+C,cAAc,OAGrCoB,OAAQ,CAENC,WAAW,EACXC,OAAQ,MAGZN,EAAWO,OAAS,SAASC,GACrBC,IAAAA,EAAU,SAASC,EAAKC,GACxBC,IAAAA,EAAK,GAEFA,OADPA,EAAGF,GAAOC,EACHC,GAETJ,EAAIK,OAAOC,KAAKN,GAAGO,OAAO,SAASC,EAAKN,GAClCE,IAAAA,EAAKC,OAAOI,OAAO,GAAIR,EAAQC,EAAKV,EAAWC,QAAQS,IAAOD,EAAQC,EAAKF,EAAEE,KAC1EG,OAAAA,OAAOI,OAAOD,EAAKJ,IACzB,IACHZ,EAAWC,QAAUY,OAAOI,OAAOjB,EAAWC,QAASO,IAGzDR,EAAWkB,YAAc,WACnB1C,GAAAA,MAAM2C,QAAQzC,UAAU,IACnBsB,OAAAA,EAAWkB,YAAYE,MAAMpB,EAAYtB,UAAU,IAExDL,IAAAA,EAAMG,MAAMC,KAAKC,WACf2C,EAAOpF,SAASU,cAAcqD,EAAWC,QAAQC,MAyDhDF,OAxDP3B,EAAIiD,OAAO,SAASC,GAAeA,OAAAA,EAAKnC,KAAMoC,IAAI,SAASD,GACnDnC,IAAAA,EAAKmC,EAAKnC,GACVqC,EAAUF,EAAKE,QACf5D,EAAQ0D,EAAK1D,OAAS,GACtB6D,EAAe1B,EAAWC,QAAQG,OAAOE,OACzCvB,EAAMD,EAAqByC,EAAKpB,QAAUoB,EAAKpB,QAAUH,EAAWC,QAAQE,SAASwB,WAAU,GA2B9F,OAzBP5C,EAAIK,GAAKA,EACTL,EAAI6C,UAAUC,IAAIlG,IACCoD,EAAIpC,cAAc,yBAA2BoC,GACrDE,UAAYwC,EACvB1C,EAAI+C,QAAQrG,GAAS,GAEnB,CAAA,MAAO,OAAQ,SAAU,QAAS,WAAY,WAAWc,QAAQ,SAASwF,GAC1EhD,EAAIlB,MAAMkE,GAAQlE,EAAMkE,IAAS,KAEnChD,EAAIlB,MAAMmE,SAAWjD,EAAIlB,MAAMmE,UAAY,WAC3CjD,EAAIlB,MAAM,WAAakB,EAAIlB,MAAM,YAAc6D,EAE7C,CAAA,QAAS,UAAUnF,QAAQ,SAASwF,GAC9BE,IAAAA,EAAQlD,EAAIpC,cAAc,wCAChCsF,IAAUA,EAAMpE,MAAMkE,GAAQlE,EAAMkE,IAAS,MAE/ChD,EAAIlB,MAAM2B,WAAa,SACvBT,EAAIQ,KAAO,WAAoBA,OAAAA,EAAKR,IACpCA,EAAIU,KAAO,WAAoBA,OAAAA,EAAKV,IACpCA,EAAIW,QAAU,WAAoBA,OAAAA,EAAQN,IAC1CL,EAAIc,aAAe,WAAoBA,OAAAA,EAAaT,IACpDL,EAAImD,eAAiB,WAAoBrC,OAAAA,EAAaT,GAAI,IAG1DD,EAAaC,EAAIL,GACV,CAACA,EAAKwC,KACZC,IAAI,SAACW,GACAC,IAAAA,EAAQD,EAAI,GACZZ,EAAOY,EAAI,GACX9B,EAAY/B,EAAgBF,EAAmBmD,EAAKlB,WAAYL,EAAWC,QAAQG,OAAOC,WAC1Fd,EAAQ,SAASE,EAAMF,GACvB,YAAgB,IAATE,OACW,IAATF,GAEiC,IAAnCS,EAAWC,QAAQG,OAAOX,QAEjB,IAATF,IAEDE,EARE,CAUXrB,EAAmBmD,EAAK9B,MAAOrB,EAAmBmD,EAAKhC,OAOnD6C,OANPf,EAAKgB,YAAYD,GACb/B,GACF+B,EAAMvC,eACJN,GACF6C,EAAM7C,OAED6C,IAEFpC,GAETA,EAAWsC,SAAW,SAASlD,GACtBxD,OAAAA,EAAUwD,IAEnBY,EAAWT,KAAO,SAASH,GAElBY,OADPpE,EAAUwD,GAAIvB,MAAM2B,WAAa,GAC1BQ,GAETA,EAAWP,KAAO,SAASL,GAElBY,OADPpE,EAAUwD,GAAIvB,MAAM2B,WAAa,SAC1BQ,GAETA,EAAWN,QAAU,SAASN,GAErBY,OADPN,EAAQN,GACDY,GAETA,EAAWuC,WAAa,WACtB1B,OAAOC,KAAKlF,GAAWW,QAAQ,KAAKmD,UAEtCM,EAAWH,aAAe,SAAST,GAE1BY,OADPpE,EAAUwD,GAAIS,eACPG,GAETA,EAAWkC,eAAiB,SAAS9C,GAE5BY,OADPpE,EAAUwD,GAAI8C,iBACPlC,GAETA,EAAWwC,kBAAoB,WAEtBxC,OADPa,OAAOC,KAAKlF,GAAWW,QAAQ,KAAK2F,gBAC7BlC,GAETA,EAAWyC,cAAgB,WAClB5B,OAAAA,OAAOC,KAAKlF,GAAWS,QAEhC2D,EAAWzD,QAAU,WACf8B,IAAAA,EAAMK,UACTmC,OAAOC,KAAKlF,GAAWW,QAAQ,SAAS6C,EAAIT,GAC3CN,EAAI,GAAG+C,MAAMpB,EAAY,CAACpE,EAAUwD,GAAKA,EAAIT,OAI3B,oBAAX+D,OAAwB,CAE7BC,IAAAA,OAAsB,IAAXvC,EAAyBA,EAASpE,OACjD2G,IAAMA,EAAEnH,GAASwE,GACjBA,EAAW4C,WAAa,WAGf5C,OADP2C,UAAaA,EAAEnH,GACRwE,QAIT0C,OAAOG,QAAU7C,EACjB0C,OAAOG,QAAQC,QAAU9C","file":"messy-popup.js","sourceRoot":"..","sourcesContent":["const vname = 'MessyPopup'\nconst aname = 'messyPopup'\nconst dataDraggableHandle = 'data-messy-draggable-handle'\nconst globalWrapperClassName = 'messy-popup'\nlet popupInfo = {}\n\n// CSS 삽입\nconst insertCss = function(css) {\n  const sheet = window.document.styleSheets[0]\n  return sheet ? (sheet.insertRule(css, sheet.cssRules.length) || true) : false\n}\nconst cssList = [\n'.messy-popup { background-color: #fff; }',\n// '.messy-popup [data-messy-content] { height: 100%; }'\n]\ncssList.forEach(insertCss)\n\nconst unbindDraggable = function() {\n  if (!this) return\n  const elmnt = this\n  const handleElement = elmnt.querySelector('[' + dataDraggableHandle + ']')\n  if (handleElement) {\n    // if present, the header is where you move the DIV from:\n    handleElement.onmousedown = undefined;\n  } else {\n    // otherwise, move the DIV from anywhere inside the DIV:\n    elmnt.onmousedown = undefined;\n  }\n}\nconst bindDraggable = function() {\n  if (!this) return\n  const elmnt = this\n\n  // from https://www.w3schools.com/howto/howto_js_draggable.asp\n  var pos1 = 0, pos2 = 0, pos3 = 0, pos4 = 0;\n  const handleElement = elmnt.querySelector('[' + dataDraggableHandle + ']')\n  if (handleElement) {\n    // if present, the header is where you move the DIV from:\n    handleElement.onmousedown = dragMouseDown;\n  } else {\n    // otherwise, move the DIV from anywhere inside the DIV:\n    elmnt.onmousedown = dragMouseDown;\n  }\n\n  function dragMouseDown(e) {\n    e = e || window.event;\n    e.preventDefault();\n    // get the mouse cursor position at startup:\n    pos3 = e.clientX;\n    pos4 = e.clientY;\n    document.onmouseup = closeDragElement;\n    // call a function whenever the cursor moves:\n    document.onmousemove = elementDrag;\n  }\n\n  function elementDrag(e) {\n    e = e || window.event;\n    e.preventDefault();\n    // calculate the new cursor position:\n    pos1 = pos3 - e.clientX;\n    pos2 = pos4 - e.clientY;\n    pos3 = e.clientX;\n    pos4 = e.clientY;\n    // set the element's new position:\n    // convert bottom to top\n    if (elmnt.style.bottom) {\n      elmnt.style.top = elmnt.offsetTop + 'px'\n      elmnt.style.bottom = ''\n    }\n    // convert right to left\n    if (elmnt.style.right) {\n      elmnt.style.left = elmnt.offsetLeft + 'px'\n      elmnt.style.right = ''\n    }\n    elmnt.style.top = (elmnt.offsetTop - pos2) + \"px\";\n    elmnt.style.left = (elmnt.offsetLeft - pos1) + \"px\";\n  }\n\n  function closeDragElement() {\n    // stop moving when mouse button is released:\n    document.onmouseup = null;\n    document.onmousemove = null;\n  }\n}\n// utils\nconst getFunctionedValue = function(arg) {\n  return typeof arg === 'function' ? arg() : arg\n}\nconst getDefinedOrNot = function() {\n  var args = Array.from(arguments)\n  for(let i = 0; i < args.length; i++) {\n    if (typeof args[i] !== 'undefined') return args[i]\n  }\n  return undefined\n  // return typeof v1 === 'undefined' ? v2 : v1\n}\nconst convertSelectorToElement = function(str) {\n  return str && typeof str === 'string' ? document.querySelector(str) : str\n}\nconst convertTextToElement = function(str) {\n  if (str && typeof str === 'string') {\n    const div = document.createElement('div')\n    div.innerHTML = str\n    return div.firstElementChild\n  } else {\n    return str\n  }\n}\nconst addPopupInfo = function(id, el) {\n  popupInfo[id] = el\n}\nconst removePopupInfo = function(id) {\n  delete popupInfo[id]\n}\nconst show = function(el) {\n  el.style.visibility = ''\n  return el\n}\nconst hide = function(el) {\n  el.style.visibility = 'hidden'\n  return el\n}\nconst destroy = function(id) {\n  const el = popupInfo[id]\n  removePopupInfo(id)\n  return el.parentNode.removeChild(el)\n}\nconst setDraggable = function(id, unset) {\n  unset = unset === false\n  const el = popupInfo[id]\n  unset ? unbindDraggable.call(el) : bindDraggable.call(el)\n}\n\nlet MessyPopup = {}\nMessyPopup._config = {\n  root: 'body',\n  wrapper: (function() {\n    const div = document.createElement('div')\n    return div\n  })(),\n  global: {\n    // hide: true,\n    draggable: true,\n    zIndex: 1000\n  }\n}\nMessyPopup.config = function(o) {\n  const wrapObj = function(key, value) {\n    var _o = {}\n    _o[key] = value\n    return _o\n  }\n  o = Object.keys(o).reduce(function(obj, key) {\n    var _o = Object.assign({}, wrapObj(key, MessyPopup._config[key]), wrapObj(key, o[key]))\n    return Object.assign(obj, _o)\n  }, {})\n  MessyPopup._config = Object.assign(MessyPopup._config, o)\n  // console.log('MessyPopup._config', MessyPopup._config)\n}\nMessyPopup.createPopup = function() {\n  if (Array.isArray(arguments[0])) {\n    return MessyPopup.createPopup.apply(MessyPopup, arguments[0])\n  }\n  var arg = Array.from(arguments)\n  const body = document.querySelector(MessyPopup._config.root)\n  arg.filter(function(item) { return item.id }).map(function(item) {\n    const id = item.id\n    const content = item.content\n    const style = item.style || {}\n    const globalZIndex = MessyPopup._config.global.zIndex\n    const div = convertTextToElement(item.wrapper ? item.wrapper : MessyPopup._config.wrapper).cloneNode(true)\n    // const div = document.createElement('div')\n    div.id = id\n    div.classList.add(globalWrapperClassName)\n    const contentDiv = div.querySelector('[data-messy-content]') || div\n    contentDiv.innerHTML = content\n    div.dataset[aname] = ''\n    // div.dataset[aname + 'Id'] = id\n    ;['top', 'left', 'bottom', 'right', 'position', 'z-index'].forEach(function(name) {\n      div.style[name] = style[name] || ''\n    })\n    div.style.position = div.style.position || 'absolute'\n    div.style['z-index'] = div.style['z-index'] || globalZIndex\n    // TEST\n    ;['width', 'height'].forEach(function(name) {\n      const child = div.querySelector('[data-messy-content] > *:first-child')\n      child && (child.style[name] = style[name] || '')\n    })\n    div.style.visibility = 'hidden'\n    div.show = function() { return show(div) }\n    div.hide = function() { return hide(div) }\n    div.destroy = function() { return destroy(id) }\n    div.setDraggable = function() { return setDraggable(id) }\n    div.unsetDraggable = function() { return setDraggable(id, false) }\n    // console.log('div', div)\n\n    addPopupInfo(id, div)\n    return [div, item]\n  }).map((arr) => {\n    const popup = arr[0]\n    const item = arr[1]\n    const draggable = getDefinedOrNot(getFunctionedValue(item.draggable), MessyPopup._config.global.draggable)\n    const show = (function(hide, show) {\n      if (typeof hide === 'undefined') {\n        if (typeof show === 'undefined') {\n          // default value of hide or show\n          return MessyPopup._config.global.hide !== true\n        }\n        return !(show === false)\n      } else {\n        return !hide\n      }\n    })(getFunctionedValue(item.hide), getFunctionedValue(item.show))\n    body.appendChild(popup)\n    if (draggable)\n      popup.setDraggable()\n    if (show) {\n      popup.show()\n    }\n    return popup\n  })\n  return MessyPopup\n}\nMessyPopup.getPopup = function(id) {\n  return popupInfo[id]\n}\nMessyPopup.show = function(id) {\n  popupInfo[id].style.visibility = ''\n  return MessyPopup\n}\nMessyPopup.hide = function(id) {\n  popupInfo[id].style.visibility = 'hidden'\n  return MessyPopup\n}\nMessyPopup.destroy = function(id) {\n  destroy(id)\n  return MessyPopup\n}\nMessyPopup.destroyAll = function() {\n  Object.keys(popupInfo).forEach(this.destroy)\n}\nMessyPopup.setDraggable = function(id) {\n  popupInfo[id].setDraggable()\n  return MessyPopup\n}\nMessyPopup.unsetDraggable = function(id) {\n  popupInfo[id].unsetDraggable()\n  return MessyPopup\n}\nMessyPopup.unsetDraggableAll = function() {\n  Object.keys(popupInfo).forEach(this.unsetDraggable)\n  return MessyPopup\n}\nMessyPopup.getPopupCount = function() {\n  return Object.keys(popupInfo).length\n}\nMessyPopup.forEach = function() {\n  var arg = arguments\n  ;Object.keys(popupInfo).forEach(function(id, i) {\n    arg[0].apply(MessyPopup, [popupInfo[id], id, i])\n  })\n}\n// w && (w[vname] = MessyPopup)\nif (typeof module === 'undefined') {\n  // global bind\n  var w = typeof global !== 'undefined' ? global : window\n  w && (w[vname] = MessyPopup)\n  MessyPopup.noConflict = function() {\n    // w && (w[vname] = undefined)\n    w && (delete w[vname])\n    return MessyPopup\n  }\n} else {\n  // module.exports bind\n  module.exports = MessyPopup\n  module.exports.default = MessyPopup\n}\n"]}